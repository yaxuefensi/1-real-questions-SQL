
2.SQL
Table Account ID
Account    date    Status  Spend
123           08-08-2018     Open    4
123           08-09-2018     Open    0
123           08-10-2018     Fraud    2
123           08-11-2018     Fraud    0

Active定义是spend > 0

Q1: What's the percentage of fraud user in active user in each date

Q2: How many user are first time labled as 'Fraud' Today








数据不是很确定，所以我加了一行，假设同一个用户一天内多笔交易，有fraud 和non fraud， 即 primary key 为account, date, status，这个逻辑一天内有多笔fraud 不行.本文原创自1point3acres论坛
Table Account ID
Account    date    Status  Spend
123           08-08-2018     Open    4
123           08-09-2018     Open    0-
123           08-10-2018     Fraud    2
123           08-10-2018     Normal  1
123           08-11-2018     Fraud    0

Active定义是spend > 0

Q1: What's the percentage of fraud user in active user in each date.本文原创自1point3acres论坛

Select date, sum(case when "status" =='Fraud' then 1 else 0 end)/count(distinct account)
from table
where account in-google 1point3acres
(select account. 1point 3acres 论坛
From table
Group by date, account
Having sum(spend)>0
) -- Find active user 
group by date

Q2: How many user are first time labled as 'Fraud' Today

Select count(account) from
(
Select Row_number() over (partition by account order by date asc) as rank, * from table 来源一亩.三分地论坛. 
Where status = 'Fraud'
)
Where rank = 1 and  date = current_date()
